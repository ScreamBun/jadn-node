{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://oasis-open.org/openc2/oc2ls/v1.1",
  "title": "OpenC2 Language Profile",
  "type": "object",
  "oneOf": [
    {
      "$ref": "#/definitions/OpenC2-Command"
    },
    {
      "$ref": "#/definitions/OpenC2-Response"
    }
  ],
  "definitions": {
    "OpenC2-Command": {
      "title": "OpenC2 Command",
      "type": "object",
      "additionalProperties": false,
      "required": [
        "action",
        "target"
      ],
      "properties": {
        "action": {
          "$ref": "#/definitions/Action"
        },
        "target": {
          "$ref": "#/definitions/Target"
        },
        "args": {
          "$ref": "#/definitions/Args"
        },
        "actuator": {
          "$ref": "#/definitions/Actuator"
        },
        "command_id": {
          "$ref": "#/definitions/Command-ID"
        }
      }
    },
    "OpenC2-Response": {
      "title": "OpenC2 Response",
      "type": "object",
      "additionalProperties": false,
      "required": [
        "status"
      ],
      "properties": {
        "status": {
          "$ref": "#/definitions/Status-Code"
        },
        "status_text": {
          "type": "string"
        },
        "results": {
          "$ref": "#/definitions/Results"
        }
      }
    },
    "Action": {
      "title": "Action",
      "type": "string",
      "oneOf": [
        {
          "const": "scan"
        },
        {
          "const": "locate"
        },
        {
          "const": "query"
        },
        {
          "const": "deny"
        },
        {
          "const": "contain"
        },
        {
          "const": "allow"
        },
        {
          "const": "start"
        },
        {
          "const": "stop"
        },
        {
          "const": "restart"
        },
        {
          "const": "cancel"
        },
        {
          "const": "set"
        },
        {
          "const": "update"
        },
        {
          "const": "redirect"
        },
        {
          "const": "create"
        },
        {
          "const": "delete"
        },
        {
          "const": "detonate"
        },
        {
          "const": "restore"
        },
        {
          "const": "copy"
        },
        {
          "const": "investigate"
        },
        {
          "const": "remediate"
        }
      ]
    },
    "Target": {
      "title": "Target",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "maxProperties": 1,
      "properties": {
        "properties": {
          "$ref": "#/definitions/Properties"
        },
        "artifact": {
          "$ref": "#/definitions/Artifact"
        },
        "command": {
          "$ref": "#/definitions/Command-ID"
        },
        "device": {
          "$ref": "#/definitions/Device"
        },
        "domain_name": {
          "$ref": "#/definitions/Domain-Name"
        },
        "email_addr": {
          "$ref": "#/definitions/Email-Addr"
        },
        "features": {
          "$ref": "#/definitions/Features"
        },
        "file": {
          "$ref": "#/definitions/File"
        },
        "idn_domain_name": {
          "$ref": "#/definitions/IDN-Domain-Name"
        },
        "idn_email_addr": {
          "$ref": "#/definitions/IDN-Email-Addr"
        },
        "ipv4_net": {
          "$ref": "#/definitions/IPv4-Net"
        },
        "ipv6_net": {
          "$ref": "#/definitions/IPv6-Net"
        },
        "ipv4_connection": {
          "$ref": "#/definitions/IPv4-Connection"
        },
        "ipv6_connection": {
          "$ref": "#/definitions/IPv6-Connection"
        },
        "iri": {
          "$ref": "#/definitions/IRI"
        },
        "mac_addr": {
          "$ref": "#/definitions/MAC-Addr"
        },
        "process": {
          "$ref": "#/definitions/Process"
        },
        "uri": {
          "$ref": "#/definitions/URI"
        }
      }
    },
    "Actuator": {
      "title": "Actuator",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "maxProperties": 1,
      "properties": {}
    },
    "Args": {
      "title": "Args",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "start_time": {
          "$ref": "#/definitions/Date-Time"
        },
        "stop_time": {
          "$ref": "#/definitions/Date-Time"
        },
        "duration": {
          "$ref": "#/definitions/Duration"
        },
        "response_requested": {
          "$ref": "#/definitions/Response-Type"
        }
      }
    },
    "Status-Code": {
      "title": "Status Code",
      "type": "integer",
      "oneOf": [
        {
          "const": 102
        },
        {
          "const": 200
        },
        {
          "const": 201
        },
        {
          "const": 400
        },
        {
          "const": 401
        },
        {
          "const": 403
        },
        {
          "const": 404
        },
        {
          "const": 500
        },
        {
          "const": 501
        },
        {
          "const": 503
        }
      ]
    },
    "Results": {
      "title": "Results",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "versions": {
          "$ref": "#/definitions/Versions"
        },
        "profiles": {
          "$ref": "#/definitions/Profiles"
        },
        "pairs": {
          "$ref": "#/definitions/Action-Targets"
        },
        "rate_limit": {
          "$ref": "#/definitions/Results$rate-limit"
        },
        "args": {
          "$ref": "#/definitions/Results$Args"
        }
      }
    },
    "Artifact": {
      "title": "Artifact",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "mime_type": {
          "type": "string"
        },
        "payload": {
          "$ref": "#/definitions/Payload"
        },
        "hashes": {
          "$ref": "#/definitions/Hashes"
        }
      }
    },
    "Device": {
      "title": "Device",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "hostname": {
          "$ref": "#/definitions/Hostname"
        },
        "idn_hostname": {
          "$ref": "#/definitions/IDN-Hostname"
        },
        "device_id": {
          "type": "string"
        }
      }
    },
    "Domain-Name": {
      "title": "Domain Name",
      "type": "string",
      "format": "hostname"
    },
    "Email-Addr": {
      "title": "Email Address",
      "type": "string",
      "format": "email"
    },
    "Features": {
      "title": "Features",
      "type": "array",
      "maxItems": 10,
      "uniqueItems": true,
      "items": {
        "$ref": "#/definitions/Feature"
      }
    },
    "File": {
      "title": "File",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "name": {
          "type": "string"
        },
        "path": {
          "type": "string"
        },
        "hashes": {
          "$ref": "#/definitions/Hashes"
        }
      }
    },
    "IDN-Domain-Name": {
      "title": "Internationalized Domain Name",
      "type": "string",
      "format": "idn-hostname"
    },
    "IDN-Email-Addr": {
      "title": "Internationalized Email Address",
      "type": "string",
      "format": "idn-email"
    },
    "IPv4-Net": {
      "title": "IPv4 Net",
      "type": "string",
      "pattern": "^((25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])(\\/(3[0-2]|[0-2]?[0-9]))?$"
    },
    "IPv4-Connection": {
      "title": "IPv4 Connection",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "src_addr": {
          "$ref": "#/definitions/IPv4-Net"
        },
        "src_port": {
          "$ref": "#/definitions/Port"
        },
        "dst_addr": {
          "$ref": "#/definitions/IPv4-Net"
        },
        "dst_port": {
          "$ref": "#/definitions/Port"
        },
        "protocol": {
          "$ref": "#/definitions/L4-Protocol"
        }
      }
    },
    "IPv6-Net": {
      "title": "IPv6 Net",
      "type": "string",
      "pattern": "^(([0-9A-Fa-f]{1,4}:){7,7}[0-9A-Fa-f]{1,4}|([0-9A-Fa-f]{1,4}:){1,7}:|([0-9A-Fa-f]{1,4}:){1,6}:[0-9A-Fa-f]{1,4}|([0-9A-Fa-f]{1,4}:){1,5}(:[0-9A-Fa-f]{1,4}){1,2}|([0-9A-Fa-f]{1,4}:){1,4}(:[0-9A-Fa-f]{1,4}){1,3}|([0-9A-Fa-f]{1,4}:){1,3}(:[0-9A-Fa-f]{1,4}){1,4}|([0-9A-Fa-f]{1,4}:){1,2}(:[0-9A-Fa-f]{1,4}){1,5}|[0-9A-Fa-f]{1,4}:((:[0-9A-Fa-f]{1,4}){1,6})|:((:[0-9A-Fa-f]{1,4}){1,7}|:)|fe80:(:[0-9A-Fa-f]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9A-Fa-f]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))(%.+)?s*(\\/([0-9]|[1-9][0-9]|1[0-1][0-9]|12[0-8]))?$"
    },
    "IPv6-Connection": {
      "title": "IPv6 Connection",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "src_addr": {
          "$ref": "#/definitions/IPv6-Net"
        },
        "src_port": {
          "$ref": "#/definitions/Port"
        },
        "dst_addr": {
          "$ref": "#/definitions/IPv6-Net"
        },
        "dst_port": {
          "$ref": "#/definitions/Port"
        },
        "protocol": {
          "$ref": "#/definitions/L4-Protocol"
        }
      }
    },
    "IRI": {
      "title": "IRI",
      "type": "string",
      "format": "iri"
    },
    "MAC-Addr": {
      "title": "MAC Address",
      "type": "string",
      "pattern": "^([0-9A-Fa-f]{2}[:-]){5}[0-9A-Fa-f]{2}(([:-][0-9A-Fa-f]){2})?$"
    },
    "Process": {
      "title": "Process",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "pid": {
          "$ref": "#/definitions/Process$pid"
        },
        "name": {
          "type": "string"
        },
        "cwd": {
          "type": "string"
        },
        "executable": {
          "$ref": "#/definitions/File"
        },
        "parent": {
          "$ref": "#/definitions/Process"
        },
        "command_line": {
          "type": "string"
        }
      }
    },
    "Properties": {
      "title": "Properties",
      "type": "array",
      "minItems": 1,
      "maxItems": 100,
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "URI": {
      "title": "URI",
      "type": "string",
      "format": "uri"
    },
    "Action-Targets": {
      "title": "Action Targets",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "scan": {
          "$ref": "#/definitions/Targets"
        },
        "locate": {
          "$ref": "#/definitions/Targets"
        },
        "query": {
          "$ref": "#/definitions/Targets"
        },
        "deny": {
          "$ref": "#/definitions/Targets"
        },
        "contain": {
          "$ref": "#/definitions/Targets"
        },
        "allow": {
          "$ref": "#/definitions/Targets"
        },
        "start": {
          "$ref": "#/definitions/Targets"
        },
        "stop": {
          "$ref": "#/definitions/Targets"
        },
        "restart": {
          "$ref": "#/definitions/Targets"
        },
        "cancel": {
          "$ref": "#/definitions/Targets"
        },
        "set": {
          "$ref": "#/definitions/Targets"
        },
        "update": {
          "$ref": "#/definitions/Targets"
        },
        "redirect": {
          "$ref": "#/definitions/Targets"
        },
        "create": {
          "$ref": "#/definitions/Targets"
        },
        "delete": {
          "$ref": "#/definitions/Targets"
        },
        "detonate": {
          "$ref": "#/definitions/Targets"
        },
        "restore": {
          "$ref": "#/definitions/Targets"
        },
        "copy": {
          "$ref": "#/definitions/Targets"
        },
        "investigate": {
          "$ref": "#/definitions/Targets"
        },
        "remediate": {
          "$ref": "#/definitions/Targets"
        }
      }
    },
    "Date-Time": {
      "title": "Date Time",
      "type": "integer",
      "minimum": 0
    },
    "Duration": {
      "title": "Duration",
      "type": "integer",
      "minimum": 0
    },
    "Feature": {
      "title": "Feature",
      "type": "string",
      "oneOf": [
        {
          "const": "versions"
        },
        {
          "const": "profiles"
        },
        {
          "const": "pairs"
        },
        {
          "const": "rate_limit"
        },
        {
          "const": "args"
        }
      ]
    },
    "Hashes": {
      "title": "Hashes",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "md5": {
          "$ref": "#/definitions/Hashes$md5"
        },
        "sha1": {
          "$ref": "#/definitions/Hashes$sha1"
        },
        "sha256": {
          "$ref": "#/definitions/Hashes$sha256"
        }
      }
    },
    "Hostname": {
      "title": "Hostname",
      "type": "string",
      "format": "hostname"
    },
    "IDN-Hostname": {
      "title": "Internationalized Hostname",
      "type": "string",
      "format": "idn-hostname"
    },
    "IPv4-Addr": {
      "title": "IPv4 Address",
      "type": "string",
      "pattern": "^((25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])$"
    },
    "IPv6-Addr": {
      "title": "IPv6 Address",
      "type": "string",
      "pattern": "^(([0-9A-Fa-f]{1,4}:){7,7}[0-9A-Fa-f]{1,4}|([0-9A-Fa-f]{1,4}:){1,7}:|([0-9A-Fa-f]{1,4}:){1,6}:[0-9A-Fa-f]{1,4}|([0-9A-Fa-f]{1,4}:){1,5}(:[0-9A-Fa-f]{1,4}){1,2}|([0-9A-Fa-f]{1,4}:){1,4}(:[0-9A-Fa-f]{1,4}){1,3}|([0-9A-Fa-f]{1,4}:){1,3}(:[0-9A-Fa-f]{1,4}){1,4}|([0-9A-Fa-f]{1,4}:){1,2}(:[0-9A-Fa-f]{1,4}){1,5}|[0-9A-Fa-f]{1,4}:((:[0-9A-Fa-f]{1,4}){1,6})|:((:[0-9A-Fa-f]{1,4}){1,7}|:)|fe80:(:[0-9A-Fa-f]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9A-Fa-f]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))(%.+)$"
    },
    "L4-Protocol": {
      "title": "Layer 4 Protocol",
      "type": "string",
      "oneOf": [
        {
          "const": "icmp"
        },
        {
          "const": "tcp"
        },
        {
          "const": "udp"
        },
        {
          "const": "sctp"
        }
      ]
    },
    "Payload": {
      "title": "Payload",
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "maxProperties": 1,
      "properties": {
        "bin": {
          "type": "string",
          "contentEncoding": "base64url"
        },
        "url": {
          "$ref": "#/definitions/URI"
        }
      }
    },
    "Port": {
      "title": "Port",
      "type": "integer",
      "minimum": 0,
      "maximum": 65535
    },
    "Response-Type": {
      "title": "Response Type",
      "type": "string",
      "oneOf": [
        {
          "const": "none"
        },
        {
          "const": "ack"
        },
        {
          "const": "status"
        },
        {
          "const": "complete"
        }
      ]
    },
    "Version": {
      "title": "Version",
      "type": "string"
    },
    "Command-ID": {
      "title": "Command ID",
      "type": "string",
      "pattern": "^\\S{0,36}$"
    },
    "Versions": {
      "title": "Versions",
      "type": "array",
      "maxItems": 10,
      "uniqueItems": true,
      "items": {
        "$ref": "#/definitions/Version"
      }
    },
    "Namespace": {
      "title": "Namespace",
      "type": "string",
      "format": "uri"
    },
    "Profiles": {
      "title": "Profiles",
      "type": "array",
      "maxItems": 100,
      "uniqueItems": true,
      "items": {
        "$ref": "#/definitions/Namespace"
      }
    },
    "Targets": {
      "title": "Targets",
      "type": "array",
      "minItems": 1,
      "maxItems": 100,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "oneOf": [
          {
            "const": "artifact"
          },
          {
            "const": "command"
          },
          {
            "const": "device"
          },
          {
            "const": "domain_name"
          },
          {
            "const": "email_addr"
          },
          {
            "const": "features"
          },
          {
            "const": "file"
          },
          {
            "const": "idn_domain_name"
          },
          {
            "const": "idn_email_addr"
          },
          {
            "const": "ipv4_net"
          },
          {
            "const": "ipv6_net"
          },
          {
            "const": "ipv4_connection"
          },
          {
            "const": "ipv6_connection"
          },
          {
            "const": "iri"
          },
          {
            "const": "mac_addr"
          },
          {
            "const": "process"
          },
          {
            "const": "properties"
          },
          {
            "const": "uri"
          }
        ]
      }
    },
    "Results$Args": {
      "title": "Results$Args",
      "type": "array",
      "maxItems": 100,
      "items": {
        "type": "string",
        "oneOf": [
          {
            "const": "start_time"
          },
          {
            "const": "stop_time"
          },
          {
            "const": "duration"
          },
          {
            "const": "response_requested"
          }
        ]
      }
    },
    "Results$rate-limit": {
      "title": "Results$rate limit",
      "type": "number",
      "minimum": 0
    },
    "Process$pid": {
      "title": "Process$pid",
      "type": "integer",
      "minimum": 0
    },
    "Hashes$md5": {
      "title": "Hashes$md5",
      "type": "string",
      "contentEncoding": "base16",
      "minLength": 16,
      "maxLength": 16
    },
    "Hashes$sha1": {
      "title": "Hashes$sha1",
      "type": "string",
      "contentEncoding": "base16",
      "minLength": 20,
      "maxLength": 20
    },
    "Hashes$sha256": {
      "title": "Hashes$sha256",
      "type": "string",
      "contentEncoding": "base16",
      "minLength": 32,
      "maxLength": 32
    }
  }
}